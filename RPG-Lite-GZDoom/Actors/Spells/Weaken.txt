ACTOR SPWeakenItem : Inventory
{
	+FLOATBOB
	+INVENTORY.ALWAYSPICKUP
	inventory.maxamount 1
	Inventory.PickupMessage "Picked up Weaken" 
	States
	{
	Spawn:
		SPFR A -1 Bright
		Stop
	}
}

ACTOR SPWeaken : CustomInventory
{
  +Inventory.Autoactivate
  +FLOATBOB
  +INVENTORY.ALWAYSPICKUP
  States
  {
  Spawn:
    SPFR A -1 Bright
    Stop
  Use:
    TNT1 A 0 A_JumpIfInventory("Mana",40,"ConfirmUse")
    TNT1 A 0 A_Print("Needs 40 mana")
	stop
  ConfirmUse:
	TNT1 A 0 A_TakeInventory("Mana",40)
	TNT1 A 0 A_Playsound("misc/p_pkup", CHAN_WEAPON)
	TNT1 A 0 A_JumpIfInventory("SKMagicPotency",5,"Power5")
	TNT1 A 0 A_JumpIfInventory("SKMagicPotency",4,"Power4")
	TNT1 A 0 A_JumpIfInventory("SKMagicPotency",3,"Power3")
	TNT1 A 0 A_JumpIfInventory("SKMagicPotency",2,"Power2")
	TNT1 A 0 A_JumpIfInventory("SKMagicPotency",1,"Power1")
	TNT1 A 0 A_FireCustomMissile("WeakenEffect")
	stop
  Power1:
	TNT1 A 0 A_FireCustomMissile("WeakenEffect1")
	stop
  Power2:
	TNT1 A 0 A_FireCustomMissile("WeakenEffect2")
	stop
  Power3:
	TNT1 A 0 A_FireCustomMissile("WeakenEffect3")
	stop
  Power4:
	TNT1 A 0 A_FireCustomMissile("WeakenEffect4")
	stop
  Power5:
	TNT1 A 0 A_FireCustomMissile("WeakenEffect5")
	stop
  }
}

Actor WeakenEffect
{
  Speed 80
  Radius 24
  Height 12
  Damage 0
  Projectile
  Translation "0:255=%[0,0,0]:[187,0,187]"
  +HITTRACER
  +DROPOFF
  States
  {
	Spawn:
		MSGA AB 4 Bright
		Loop
	Death:
		MSGA C 4 Bright ACS_NamedExecuteAlways("SpellWeaken",0,20)
		MSGA DEFG 3 Bright
		Stop
  }
}

Actor WeakenEffect1 : WeakenEffect
{
  States
  {
	Death:
		MSGA C 4 Bright ACS_NamedExecuteAlways("SpellWeaken",0,24)
		MSGA DEFG 3 Bright
		Stop
  }
}

Actor WeakenEffect2 : WeakenEffect
{
  States
  {
	Death:
		MSGA C 4 Bright ACS_NamedExecuteAlways("SpellWeaken",0,28)
		MSGA DEFG 3 Bright
		Stop
  }
}

Actor WeakenEffect3 : WeakenEffect
{
  States
  {
	Death:
		MSGA C 4 Bright ACS_NamedExecuteAlways("SpellWeaken",0,32)
		MSGA DEFG 3 Bright
		Stop
  }
}

Actor WeakenEffect4 : WeakenEffect
{
  States
  {
	Death:
		MSGA C 4 Bright ACS_NamedExecuteAlways("SpellWeaken",0,36)
		MSGA DEFG 3 Bright
		Stop
  }
}

Actor WeakenEffect5 : WeakenEffect
{
  States
  {
	Death:
		MSGA C 4 Bright ACS_NamedExecuteAlways("SpellWeaken",0,40)
		MSGA DEFG 3 Bright
		Stop
  }
}